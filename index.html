<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Flashcards</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --orange-1: #ff9f1c;
      --orange-2: #ff6b35;
      --bg-a: #a8edea;
      --bg-b: #fed6e3;
      --card-shadow: 0 8px 20px rgba(16,24,40,0.12);
    }

    /* ===== Body & background ===== */
    html,body{height:100%;margin:0;font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;color:#222;background: linear-gradient(135deg,var(--bg-a),var(--bg-b));-webkit-font-smoothing:antialiased;}
    main{flex:1}

    /* ===== Bandeau orange (hero) ===== */
    .hero{
      background: linear-gradient(90deg,var(--orange-1),var(--orange-2));
      color: white;
      padding: 28px 20px 56px 20px;
      position: relative;
      overflow: visible;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    }
    .hero-inner{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .hero-left{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .hero-left .small{
      font-size:14px;
      opacity:0.95;
      letter-spacing:0.6px;
    }
    .hero-left h1{
      margin:0;
      font-size:34px;
      line-height:1;
      font-weight:700;
      letter-spacing:-0.6px;
      text-shadow:0 2px 10px rgba(0,0,0,0.08);
    }

    /* create button top-right */
    .hero .create-btn{
      background: rgba(255,255,255,0.98);
      color: var(--orange-2);
      border: none;
      padding:10px 16px;
      border-radius:999px;
      font-weight:700;
      cursor:pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      transition:transform .14s ease;
    }
    .hero .create-btn:hover{ transform: translateY(-3px); }

    /* mini flashcards illustration (empilées) */
    .hero-art{
      position:absolute;
      left:50%;
      transform: translateX(-50%);
      bottom:-28px;
      display:flex;
      gap: -28px;
      pointer-events:none;
    }
    .mini-card{
      width:120px;
      height:72px;
      border-radius:12px;
      box-shadow: var(--card-shadow);
      background: linear-gradient(180deg,#ffffff, #fff6ea);
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      font-weight:600;
      color:#333;
      transform-origin:center;
      border: 1px solid rgba(0,0,0,0.04);
    }
    .mini-card:nth-child(1){ transform: rotate(-8deg) translateX(-20px); background: linear-gradient(180deg,#ffffff,#fff3f0);}
    .mini-card:nth-child(2){ transform: rotate(2deg); z-index:2; background: linear-gradient(180deg,#ffffff,#eefcff);}
    .mini-card:nth-child(3){ transform: rotate(8deg) translateX(20px); background: linear-gradient(180deg,#fffef6,#fff9e6); }

    .mini-card .q{ font-size:14px; opacity:0.9; }
    .mini-card .a{ font-size:11px; opacity:0.65; margin-top:6px; }

    /* ===== Levels grid ===== */
    .container{
      max-width:1200px;
      margin: 60px auto 40px;
      padding:0 18px;
    }
    .levels{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(240px,1fr));
      gap:18px;
    }

    .level-card{
      background: white;
      border-radius:16px;
      padding:20px;
      display:flex;
      gap:12px;
      align-items:center;
      box-shadow: var(--card-shadow);
      cursor:pointer;
      transition: transform .16s ease, box-shadow .16s ease;
      border: 1px solid rgba(0,0,0,0.03);
    }
    .level-card:hover{ transform: translateY(-6px); box-shadow: 0 14px 30px rgba(16,24,40,0.12); }

    /* Icon square */
    .icon-square{
      width:72px;
      height:72px;
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-shrink:0;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      color: white;
      font-size:28px;
    }
    .icon-blue{ background: linear-gradient(180deg,#4e73df,#6c8cff); }
    .icon-teal{ background: linear-gradient(180deg,#06b6d4,#3dd6e9); }
    .icon-green{ background: linear-gradient(180deg,#16a34a,#4ade80); }
    .icon-amber{ background: linear-gradient(180deg,#f59e0b,#fbbf24); }

    .level-body h3{ margin:0; font-size:18px; }
    .level-body p{ margin:6px 0 0; font-size:13px; color:#666; }

    /* ===== Modal chapters ===== */
    .modal{ display:none; position:fixed; inset:0; background: rgba(0,0,0,0.55); align-items:center; justify-content:center; z-index:60; }
    .modal .card{ background:white; border-radius:12px; padding:20px; width: min(420px,92%); box-shadow: var(--card-shadow); position:relative; }
    .modal h2{ margin:0 0 12px; }
    .chapter-list{ list-style:none;padding:0;margin:0; display:flex; flex-direction:column; gap:8px; }
    .chapter-list li{ padding:10px 12px; border-radius:8px; background:#f7f7f8; cursor:pointer; border:1px solid rgba(0,0,0,0.03); }
    .chapter-list li:hover{ background:#eef3ff }

    .modal .start-btn{ margin-top:12px; background: linear-gradient(90deg,#2ecc71,#16a34a); color:white; border:none; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700; }

    .modal .close{ position:absolute; top:8px; right:10px; font-size:20px; cursor:pointer; color:#666; }

    /* ===== Create section ===== */
    #createSection{ display:none; max-width:980px; margin:26px auto; background:white; border-radius:14px; padding:18px; box-shadow: var(--card-shadow); }
    .form-row{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:8px; }
    textarea{ width:100%; min-height:90px; padding:10px; border-radius:10px; border:1px solid #e6e6e9; resize:vertical; font-size:14px; }
    input[type=file]{ display:block; }
    .muted{ color:#666; font-size:13px; margin-top:8px; }

    .controls{ display:flex; gap:8px; margin-top:10px; align-items:center; }
    .btn{ padding:8px 12px; border-radius:10px; border:none; cursor:pointer; font-weight:700; }
    .btn-add{ background: linear-gradient(90deg,var(--orange-1),var(--orange-2)); color:white; }
    .btn-secondary{ background:#f3f4f6; color:#111; }

    /* ===== Cards preview ===== */
    #cardsList{ margin-top:14px; display:flex; gap:12px; flex-wrap:wrap; justify-content:center; }
    .flashcard{ width:220px; height:140px; perspective:1000px; cursor:pointer; }
    .flashcard-inner{ width:100%; height:100%; position:relative; transition: transform .6s; transform-style:preserve-3d; }
    .flashcard.flipped .flashcard-inner{ transform: rotateY(180deg); }
    .front, .back { position:absolute; inset:0; border-radius:12px; backface-visibility:hidden; display:flex; align-items:center; justify-content:center; text-align:center; padding:12px; font-weight:600; box-shadow: 0 6px 14px rgba(0,0,0,0.08); }
    .front{ background: linear-gradient(180deg,#ffffff,#fff7ef); color:#222; }
    .back{ background: linear-gradient(180deg,#eef7ff,#e6f0ff); color:#222; transform: rotateY(180deg); }

    /* responsive tweaks */
    @media (max-width:720px){
      .hero-inner{ flex-direction:column; align-items:flex-start; gap:10px; padding-bottom:20px; }
      .hero-art{ left: 50%; transform: translateX(-50%); bottom:-24px; }
      .level-card{ padding:16px; }
      .icon-square{ width:56px;height:56px; border-radius:10px; font-size:22px; }
      .mini-card{ width:100px; height:60px; }
    }
  </style>
</head>
<body>

  <!-- ===== HERO (bandeau orange) ===== -->
  <header class="hero" role="banner">
    <div class="hero-inner">
      <div class="hero-left">
        <div class="small">Les cartes</div>
        <h1>Flashcards</h1>
      </div>

      <div>
        <button class="create-btn" onclick="toggleCreate()">✏️ Créer</button>
      </div>
    </div>

    <!-- mini illustration cards (empilées) -->
    <div class="hero-art" aria-hidden="true">
      <div class="mini-card">
        <div class="q">f(x)=x²</div>
        <div class="a">→ dérivée 2x</div>
      </div>
      <div class="mini-card">
        <div class="q">sin²+cos²</div>
        <div class="a">=1</div>
      </div>
      <div class="mini-card">
        <div class="q">∫0^1 x dx</div>
        <div class="a">=1/2</div>
      </div>
    </div>
  </header>

  <!-- ===== Main content ===== -->
  <main class="container" role="main">
    <!-- Levels -->
    <section id="levelsSection">
      <div class="levels" id="levelsGrid">
        <!-- Seconde -->
        <article class="level-card" onclick="openModal('Seconde')">
          <div class="icon-square icon-blue" aria-hidden="true">
            <!-- graduation cap simplified -->
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2L2 7l10 5 10-5-10-5z" fill="white"/>
              <path d="M4 10v4c0 3.5 4 6 8 6s8-2.5 8-6v-4" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" opacity="0.95"/>
            </svg>
          </div>
          <div class="level-body">
            <h3>Seconde</h3>
            <p class="muted">Bases / Fonctions / Géométrie</p>
          </div>
        </article>

        <!-- Première -->
        <article class="level-card" onclick="openModal('Première')">
          <div class="icon-square icon-teal">
            <!-- open book -->
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 6c4 0 6-2 9-2s5 2 9 2v12c-4 0-6 2-9 2s-5-2-9-2V6z" fill="white"/>
            </svg>
          </div>
          <div class="level-body">
            <h3>Première</h3>
            <p class="muted">Suites / Probabilités / Analyse</p>
          </div>
        </article>

        <!-- Terminale -->
        <article class="level-card" onclick="openModal('Terminale')">
          <div class="icon-square icon-green">
            <!-- closed book -->
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
              <rect x="3" y="4" width="14" height="16" rx="1.5" fill="white"/>
              <path d="M17 6h4v12h-4" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="level-body">
            <h3>Terminale</h3>
            <p class="muted">Dérivées / Intégrales / Logarithmes</p>
          </div>
        </article>

        <!-- Maths expertes -->
        <article class="level-card" onclick="openModal('Maths expertes')">
          <div class="icon-square icon-amber">
            <!-- abacus-like -->
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
              <rect x="3" y="4" width="18" height="2" rx="1" fill="white"/>
              <rect x="3" y="10" width="18" height="2" rx="1" fill="white"/>
              <rect x="3" y="16" width="18" height="2" rx="1" fill="white"/>
            </svg>
          </div>
          <div class="level-body">
            <h3>Maths expertes</h3>
            <p class="muted">Complexes / Graphes / Matrices</p>
          </div>
        </article>
      </div>
    </section>

    <!-- Create section (hidden by default) -->
    <section id="createSection" aria-hidden="true">
      <h2>Créer une nouvelle carte</h2>

      <label class="muted">Recto</label>
      <textarea id="frontText" placeholder="Texte recto (LaTeX possible brut)"></textarea>
      <input id="frontImg" type="file" accept="image/*">

      <label class="muted">Verso</label>
      <textarea id="backText" placeholder="Texte verso"></textarea>
      <input id="backImg" type="file" accept="image/*">

      <div class="controls">
        <button class="btn btn-add" id="addCardBtn">Ajouter la carte</button>
        <button class="btn btn-secondary" onclick="exportDeck()">Exporter (.json)</button>
        <div style="flex:1"></div>
        <div class="muted">Aperçu des cartes créées</div>
      </div>

      <div id="cardsList" aria-live="polite"></div>
    </section>
  </main>

  <!-- Modal Chapitres -->
  <div class="modal" id="chapterModal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="card">
      <div class="close" onclick="closeModal()">✕</div>
      <h2 id="modalTitle">Chapitres</h2>
      <ul class="chapter-list" id="chapterList"></ul>
      <button class="start-btn" onclick="startRevision()">▶️ Commencer</button>
    </div>
  </div>

  <script>
    /* ===== Données de test (chapitres) ===== */
    const chapters = {
      "Seconde": ["Chapitre 1 : Bases", "Chapitre 2 : Fonctions", "Chapitre 3 : Géométrie"],
      "Première": ["Chapitre 1 : Suites", "Chapitre 2 : Probabilités", "Chapitre 3 : Analyse"],
      "Terminale": ["Chapitre 1 : Dérivées", "Chapitre 2 : Intégrales", "Chapitre 3 : Logarithmes"],
      "Maths expertes": ["Chapitre 1 : Nombres complexes", "Chapitre 2 : Graphes", "Chapitre 3 : Matrices"]
    };

    let currentLevel = null;
    let selectedChapter = null;
    let deck = []; // cartes créées en mémoire

    /* ===== Modal open/close ===== */
    function openModal(level){
      currentLevel = level;
      selectedChapter = null;
      document.getElementById('modalTitle').textContent = level + " — Chapitres";
      const list = document.getElementById('chapterList');
      list.innerHTML = "";
      (chapters[level] || []).forEach(chap=>{
        const li = document.createElement('li');
        li.textContent = chap;
        li.onclick = ()=> {
          // visuel de sélection
          Array.from(list.children).forEach(c=>c.style.background='');
          li.style.background = '#dfefff';
          selectedChapter = chap;
        };
        list.appendChild(li);
      });
      const modal = document.getElementById('chapterModal');
      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden','false');
    }
    function closeModal(){
      const modal = document.getElementById('chapterModal');
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden','true');
      selectedChapter = null;
    }

    function startRevision(){
      if(!selectedChapter){
        alert("Sélectionne un chapitre avant de commencer.");
        return;
      }
      // placeholder - tu brancheras ici le vrai mode révision
      alert("Démarrage : " + currentLevel + " — " + selectedChapter);
      closeModal();
    }

    /* ===== Toggle create section ===== */
    function toggleCreate(){
      const create = document.getElementById('createSection');
      const levels = document.getElementById('levelsSection');
      if(create.style.display === 'block'){
        create.style.display = 'none';
        levels.style.display = '';
      } else {
        create.style.display = 'block';
        levels.style.display = 'none';
        create.setAttribute('aria-hidden','false');
      }
    }

    /* ===== Gestion des cartes (création / aperçu / export) ===== */
    function readFileAsDataURL(file){
      return new Promise((res, rej)=>{
        const r = new FileReader();
        r.onload = ()=> res(r.result);
        r.onerror = e => rej(e);
        r.readAsDataURL(file);
      });
    }

    async function addCard(){
      const fTxt = document.getElementById('frontText').value.trim();
      const bTxt = document.getElementById('backText').value.trim();
      const fFile = document.getElementById('frontImg').files[0];
      const bFile = document.getElementById('backImg').files[0];
      let fImg = "", bImg = "";
      if(fFile) fImg = await readFileAsDataURL(fFile);
      if(bFile) bImg = await readFileAsDataURL(bFile);

      if(!fTxt && !bTxt && !fImg && !bImg){ alert("Ajoute du texte ou une image."); return; }

      deck.push({ front: fTxt, back: bTxt, frontImg: fImg, backImg: bImg });
      renderCardsPreview();

      // reset form
      document.getElementById('frontText').value = '';
      document.getElementById('backText').value = '';
      document.getElementById('frontImg').value = '';
      document.getElementById('backImg').value = '';
    }

    function renderCardsPreview(){
      const list = document.getElementById('cardsList');
      list.innerHTML = '';
      deck.forEach((c, idx)=>{
        const wrap = document.createElement('div');
        wrap.className = 'flashcard';
        wrap.innerHTML = `
          <div class="flashcard-inner" data-idx="${idx}">
            <div class="front">
              ${c.frontImg ? `<img src="${c.frontImg}" style="max-width:84%; max-height:58px; border-radius:8px">` : ''}
              <div style="padding:8px">${escapeHtml(c.front||'')}</div>
            </div>
            <div class="back">
              ${c.backImg ? `<img src="${c.backImg}" style="max-width:84%; max-height:58px; border-radius:8px">` : ''}
              <div style="padding:8px">${escapeHtml(c.back||'')}</div>
            </div>
          </div>`;
        wrap.addEventListener('click', ()=> wrap.classList.toggle('flipped'));
        list.appendChild(wrap);
      });
    }

    function escapeHtml(s){
      return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('\n','<br>');
    }

    function exportDeck(){
      if(deck.length === 0){ alert("Aucune carte à exporter."); return; }
      const payload = { name: "mon-deck", cards: deck };
      const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'mes-cartes.json';
      a.click();
      URL.revokeObjectURL(a.href);
    }

    // events
    document.getElementById('addCardBtn').addEventListener('click', addCard);

    // close modal with Esc or click outside
    window.addEventListener('keydown', (e)=> { if(e.key === 'Escape') closeModal(); });
    document.getElementById('chapterModal').addEventListener('click', (ev)=>{
      if(ev.target === document.getElementById('chapterModal')) closeModal();
    });
  </script>
</body>
</html>
